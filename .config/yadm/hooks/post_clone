#!/bin/sh

cd "$HOME"

echo "Init submodules"
yadm submodule set-url .config/nvim "https://github.com/kewuaa/nvim.git"
yadm submodule update --init --recursive
yadm submodule set-url .config/nvim "git@github.com:kewuaa/nvim.git"

echo "Updating the yadm repo origin URL"
yadm remote set-url origin "git@github.com:kewuaa/dotfiles.git"

if [[ ! -f "${YADM_HOOK_REPO}/info/sparse-checkout" ]]; then
  yadm gitconfig core.sparseCheckout true
  cat << EOF > "${YADM_HOOK_REPO}/info/sparse-checkout"
# Generated by $0
/*
!.gitmodules
!README.md
EOF
  yadm checkout --quiet
fi
